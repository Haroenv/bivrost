
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Data Source Â· Bivrost</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="fetch-api-call.html" />
    
    
    <link rel="prev" href="adapter.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="api-function.html">
            
                <a href="api-function.html">
            
                    
                    Api Function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="adapter.html">
            
                <a href="adapter.html">
            
                    
                    Adapter
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3" data-path="data-source.html">
            
                <a href="data-source.html">
            
                    
                    Data Source
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="fetch-api-call.html">
            
                <a href="fetch-api-call.html">
            
                    
                    Fetch API Call
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <a target="_blank" href="https://github.com/tuchk4/bivrost">
            
                    
                    Bivrost at GitHub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../recipes/">
            
                <a href="../recipes/">
            
                    
                    Recipes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../recipes/api-enchantment.html">
            
                <a href="../recipes/api-enchantment.html">
            
                    
                    Api Enchantment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../recipes/auto-invoke-methods.html">
            
                <a href="../recipes/auto-invoke-methods.html">
            
                    
                    Auto Invoke Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../recipes/data-source-immutable.html">
            
                <a href="../recipes/data-source-immutable.html">
            
                    
                    Immutable Output
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../recipes/data-source-type-checking.html">
            
                <a href="../recipes/data-source-type-checking.html">
            
                    
                    Type checking with tcomb
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../recipes/generate-crud-methods.html">
            
                <a href="../recipes/generate-crud-methods.html">
            
                    
                    CRUD Data Source
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../recipes/file-upload.html">
            
                <a href="../recipes/file-upload.html">
            
                    
                    File Upload
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../recipes/fixtures.html">
            
                <a href="../recipes/fixtures.html">
            
                    
                    Fixtures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../recipes/default-response.html">
            
                <a href="../recipes/default-response.html">
            
                    
                    Default Api Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../recipes/prepare-process.html">
            
                <a href="../recipes/prepare-process.html">
            
                    
                    Prepare Request and Process Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../recipes/validation.html">
            
                <a href="../recipes/validation.html">
            
                    
                    Data Validation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Adapters</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../adapters.html">
            
                <a href="../adapters.html">
            
                    
                    Adapeters List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" >
            
                <a target="_blank" href="https://github.com/tuchk4/bivrost/tree/master/packages/bivrost-fetch-adapter">
            
                    
                    Fetch Adapter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" >
            
                <a target="_blank" href="https://github.com/tuchk4/bivrost/tree/master/packages/bivrost-axios-adapter">
            
                    
                    Axios Adapter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" >
            
                <a target="_blank" href="https://github.com/tuchk4/bivrost/tree/master/packages/bivrost-delay-adapter">
            
                    
                    Delay Adapter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" >
            
                <a target="_blank" href="https://github.com/tuchk4/bivrost/tree/master/packages/bivrost-local-storage-adapter">
            
                    
                    LocalStorage Adapter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" >
            
                <a target="_blank" href="https://github.com/tuchk4/bivrost/tree/master/packages/bivrost-save-blob-adapter">
            
                    
                    Save Blob Adapter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../testing.html">
            
                <a href="../testing.html">
            
                    
                    Testing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../contributing.html">
            
                <a href="../contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Data Source</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="data-source">Data source</h1>
<p>A DataSource - is a group of several API methods and its configuration. Every method call passes with the configured steps. Result of each step will be passed as arguments to the next step and whole steps chain will be cached if cache is enabled.</p>
<p>A DataSource provide methods for:</p>
<ul>
<li>steps configuration</li>
<li>steps executing</li>
<li>cache manipulations</li>
<li>request deduplication</li>
</ul>
<h3 id=""><a id="this-gist"></a></h3>
<h3 id="the-gist"><a href="#this-gist">#</a> The gist</h3>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> DataSource <span class="token keyword">from</span> <span class="token string">&apos;bivrost/data/source&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> bivrostApi <span class="token keyword">from</span> <span class="token string">&apos;bivrost/http/api&apos;</span>
<span class="token keyword">import</span> fetchAdapter <span class="token keyword">from</span> <span class="token string">&apos;bivrost-fetch-adapter&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Record <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;immutable&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token function">bivrostApi</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  host<span class="token punctuation">:</span> <span class="token string">&apos;localhost&apos;</span><span class="token punctuation">,</span>
  adapter<span class="token punctuation">:</span> <span class="token function">fetchAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">Record</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> steps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;validate&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;api&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;model&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span>
    loadAll<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      isGlobal<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      ttl<span class="token punctuation">:</span> <span class="token number">60000</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> validate <span class="token operator">=</span> <span class="token punctuation">{</span>
    update<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&apos;&quot;ID&quot; field is required for user update&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> api <span class="token operator">=</span> <span class="token punctuation">{</span>
    loadAll<span class="token punctuation">:</span> <span class="token function">api</span><span class="token punctuation">(</span><span class="token string">&apos;GET /users&apos;</span><span class="token punctuation">)</span>
    update<span class="token punctuation">:</span> <span class="token function">api</span><span class="token punctuation">(</span><span class="token string">&apos;PUT /user/:id&apos;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> model <span class="token operator">=</span> <span class="token punctuation">{</span>
    update<span class="token punctuation">:</span> User
  <span class="token punctuation">}</span>

  <span class="token function">update</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&apos;update&apos;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">loadAll</span><span class="token punctuation">(</span>filters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&apos;loadAll&apos;</span><span class="token punctuation">,</span> filters<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

usersDataSource<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// if previous loadAll call IS NOT finished:</span>
<span class="token comment" spellcheck="true">//  - will not trigger step chain because of deduplication</span>
usersDataSource<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// if previous loadAll call IS finished - will not trigger step chain.</span>
<span class="token comment" spellcheck="true">//  - will not trigger step chain because of enabled cache</span>
usersDataSource<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id=""><a id="constructor"></a></h3>
<h3 id="constructor-headers-context-steps-options-"><a href="#constructor">#</a> constructor({ headers, context, steps, options })</h3>
<p>As constructor arguments (all arguments are optional):</p>
<ul>
<li><em>headers</em> - additional headers</li>
<li><em>steps</em> - step sequence</li>
<li><em>context</em> - context object. Final context is calculated with:<ul>
<li>DataSource context (passed as argument to DataSource constructor)</li>
<li><a href="#invoke">invoke()</a> context (passed as third param to invoke function)</li>
</ul>
</li>
<li><em>options</em> - any data will be saved in data source instance</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> DataSource <span class="token keyword">from</span> <span class="token string">&apos;bivrost/data/source&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AppDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      options<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      steps<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&apos;validate&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;serialize&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;api&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      context<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      headers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id=""><a id="invoke"></a></h3>
<h3 id="invokemethod-string-params-object-context-object"><a href="#invoke">#</a> invoke(method: string, params: object, context: object)</h3>
<pre class="language-"><code class="lang-js">DataSource<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span>method<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>params<span class="token punctuation">:</span> object<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>context<span class="token punctuation">:</span> object<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now Bivrost generates <a href="../recipes/auto-invoke-methods.html">Auto Invoke Methods</a></p>
<p>Invoke is a data source&apos;s function that execute <em>method</em> chain and pass <em>params</em> as initial arguments and <em>context</em> as second.</p>
<p>Method&apos;s chain - sequence of steps where each step is a <em>function</em> and its result is an argument for the next step (like lodash&apos;s flow).</p>
<p><em>context</em> - is useful when you need to pass the same object to all steps. For example - dynamic <em>params</em> validation or step&apos;s configuration.</p>
<p>Steps sequence could configured as second argument to data source constructor or as property <em>steps</em>. If there is no method configuration at step - it will be skipped.</p>
<p>Default steps sequence:</p>
<ul>
<li><em>prepare</em> - used for request data transformation and serialization</li>
<li><em>api</em> - api call</li>
<li><em>process</em> - process the response</li>
</ul>
<h2 id=""><a id="invoke-steps"></a></h2>
<h3 id="invoke-steps"><a href="#invoke-steps">#</a> Invoke steps</h3>
<p>As property:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> DataSource <span class="token keyword">from</span> <span class="token string">&apos;bivrost/data/source&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AppDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> steps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;validate&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;serialize&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;api&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>In this example - there are three steps for <em>invoke</em> function - <em>validate</em>, <em>serialize</em> and <em>api</em>. Steps sequence and naming - just a developer fantasy and depends on application architecture and requirements.</p>
<h2 id=""><a id="step-configuration"></a></h2>
<h3 id="step-configuration"><a href="#step-configuration">#</a> Step configuration</h3>
<p>Step could be configured as <em>object</em> or as <em>function</em>.</p>
<ul>
<li>If step is configured as object:</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">UserDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> steps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;api&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> api <span class="token operator">=</span> <span class="token punctuation">{</span>
    loadAll<span class="token punctuation">:</span> <span class="token function">api</span><span class="token punctuation">(</span><span class="token string">&apos;GET /users&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&apos;loadAll&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>If step is configured as function - it will be executed for all methods:</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">UserDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> steps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;api&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;immutable&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> immutable <span class="token operator">=</span> response <span class="token operator">=</span><span class="token operator">&gt;</span> Immutable<span class="token punctuation">.</span><span class="token function">fromJSON</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> api <span class="token operator">=</span> <span class="token punctuation">{</span>
    loadAll<span class="token punctuation">:</span> <span class="token function">api</span><span class="token punctuation">(</span><span class="token string">&apos;GET /users&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">loadAll</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&apos;loadAll&apos;</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id=""><a id="cache"></a></h2>
<h3 id="cache"><a href="#cache">#</a> Cache</h3>
<p>Define default cache config for all data source methods:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">UserDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> defaultCache <span class="token operator">=</span> <span class="token punctuation">{</span>
    enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    isGlobal<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    ttl<span class="token punctuation">:</span> <span class="token number">60000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Define cache config for specific data source method:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">UserDataSource</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span>
    loadAll<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      isGlobal<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      ttl<span class="token punctuation">:</span> <span class="token number">60000</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Configuration is almost same as invoke steps. Cache options:</p>
<ul>
<li><em>enabled: boolean</em> - enable / disable cache for method</li>
<li><em>isGlobal: boolean</em> - enable / disable global method cache. If <em>true</em> - cache will be shared between all data source instances.</li>
<li><em>ttl: integer</em> - cache lifetime in miliseconds</li>
</ul>
<p>Cache methods:</p>
<ul>
<li><p><em>getCacheKey(method: string, params: object)</em> - Hook for cache key generating. By default cache key is `JSON.stringify(params)``</p>
</li>
<li><p><em>clearCache(method: string)</em> - Clear method caches. If <em>method</em> argument is not specified - clear all data source caches.</p>
</li>
</ul>
<h2 id=""><a id="debug-logs"></a></h2>
<h3 id="debug-logs"><a href="#debug-logs">#</a> Debug logs</h3>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> appDataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
appDataSource<span class="token punctuation">.</span><span class="token function">enableDebugLogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
appDataSource<span class="token punctuation">.</span><span class="token function">disableDebugLogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>If logs are enabled - data source will post messages to console for each step with its parameters. <a href="https://www.npmjs.com/package/bows" target="_blank">bows</a> is used for logging and thats why <code>localStorage.debug = true</code> should be set in your console to see messages.</p>
<p><img src="http://i.imgur.com/FOC5z5e.png" alt="Bivrost logs"></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="adapter.html" class="navigation navigation-prev " aria-label="Previous page: Adapter">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="fetch-api-call.html" class="navigation navigation-next " aria-label="Next page: Fetch API Call">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Data Source","level":"1.2.3","depth":2,"next":{"title":"Fetch API Call","level":"1.2.4","depth":2,"path":"docs/basics/fetch-api-call.md","ref":"docs/basics/fetch-api-call.md","articles":[]},"previous":{"title":"Adapter","level":"1.2.2","depth":2,"path":"docs/basics/adapter.md","ref":"docs/basics/adapter.md","articles":[]},"dir":"ltr"},"config":{"plugins":["edit-link","prism","-highlight","github","ga","anker-enable"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{},"github":{"url":"https://github.com/tuchk4/bivrost"},"anker-enable":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"ga":{"configuration":"auto","token":"UA-89488143-1"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/tuchk4/bivrost/tree/master"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Bivrost","gitbook":">=3.2.1"},"file":{"path":"docs/basics/data-source.md","mtime":"2017-12-15T10:06:22.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-12-15T10:07:13.671Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-anker-enable/anker.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

